<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <link rel="stylesheet" href="styles.css?v=1">
</head>

<body>

<h1 class='ui large header'  id="trustoveriptoiptechnologyarchitecturespecification">Trust over IP (ToIP) Technology Architecture Specification</h1>
<h4 class='ui smallest header'  id="revisionhistory">Revision History</h4>
<h4 class='ui smallest header'  id="editors">Editors:</h4>
<h4 class='ui smallest header'  id="contributors">Contributors:</h4>
<p>*Copyright: *</p>
<h2 class='ui medium header'  id="1introduction">1. Introduction</h2>
<p>The mission of the <a href="https://www.trustoverip.org">Trust over IP (ToIP) Foundation</a> is to define an overall architecture for Internet-scale digital trust that combines cryptographic assurance at the machine layers (technology) with human accountability at the business, legal, and social layers (governance). Together these two halves form a complete four-layer architecture for decentralized digital trust infrastructure known as the <a href="https://trustoverip.github.io/toip/glossary#toip-stack">ToIP stack</a>. Figure 1 is a conceptual diagram of this stack:</p>
<p><img src="/images/ToIPDualStack.jpeg" alt="ToIP Dual Stack" style="width:800px;"/></p>
<p><strong>Figure 1: Conceptial diagram of the ToIP stack</strong></p>
<p>This document is the normative specification for the high-level architecture of the ToIP technology stack (the left half of Figure 1).  It is a deliverable of the <a href="https://wiki.trustoverip.org/display/HOME/Technology+Stack+Working+Group">Technology Stack Working Group</a> at the ToIP Foundation. It is recommended to read this document in conjunction with these three other documents from the ToIP Foundation in the following order:</p>
<ol>
<li class='ui item' ><p><a href="https://www.trustoverip.org/wp-content/uploads/Introduction-to-ToIP-V2.0-2021-11-17.pdf">Introduction to ToIP</a> is our white paper that provides an overall introduction to the emergence of decentralized digital trust infrastructure. It explains the origin and basic structure of the ToIP stack together with the mission and activities of the ToIP Foundation.</p></li>
<li class='ui item' ><p><a href="https://docs.google.com/document/d/1RKbHtqTRxlefkTTo4AgKW-Mwz631Z7Ufn0-oKqi9XxY/edit">Evolution of the ToIP Stack</a> is a companion document to this specification that explains the overall process the ToIP Foundation is following in the development of the ToIP stack. It is recommended for anyone seeking to understand how the work of the ToIP Foundation relates to that of adjacent non-profit organizations such as the Decentralized Identity Foundation, the OpenID Foundation, the Open Identity Exchange, and others including established SDOs such as W3C, IETF, ISO, etc. See <a href="#appendix-b-mapping-of-existing-technologies-into-the-toip-stack">Appendix B</a> for more. </p></li>
<li class='ui item' ><p><a href="https://www.trustoverip.org/wp-content/uploads/Design-Principles-for-the-ToIP-Stack-V1.0-2022-01-17.pdf">Design Principles for the ToIP Stack</a> is the immediate predecessor to this specification (see the development tracks described in <a href="#4-audience-purpose-and-scope">Section 4</a>). It enumerates the set of design principles informing, guiding, and constraining the design of the ToIP stack. We especially recommend this document for a complete understanding of this specification.</p></li>
</ol>
<p>As with all ToIP deliverables, the ToIP Foundation invites your feedback and suggestions. Please contact us via the <a href="https://www.trustoverip.org/">ToIP Foundation website</a>.</p>
<h2 class='ui medium header'  id="2terminology">2. Terminology</h2>
<p>In this document, the key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL", when appearing in ALL CAPITALS, are to be interpreted as described in <a href="https://datatracker.ietf.org/doc/html/rfc2119">IETF RFC 2119</a>.</p>
<p>All other defined terms are linked to their definitions in the applicable ToIP <a href="https://trustoverip.github.io/ctwg/glossary#glossary">glossary</a> following the process defined by the <a href="https://wiki.trustoverip.org/pages/viewpage.action?pageId=65700">ToIP Concepts and Terminology Working Group</a>(CTWG). The glossaries cited in this specification include:</p>
<ul class='ui list' >
<li class='ui item' ><a href="https://trustoverip.github.io/toip/glossary">The ToIP Core Glossary</a></li>
<li class='ui item' ><a href="https://trustoverip.github.io/ctwg/glossary">The CTWG Glossary</a></li>
<li class='ui item' ><a href="https://trustoverip.github.io/tswg/glossary">The TSWG Glossary</a></li>
<li class='ui item' ><a href="https://trustoverip.github.io/essiflab/glossary">The eSSIF-Lab Glossary</a></li>
</ul>
<p>Terms that especially vital to this specification are also explained inline.</p>
<h2 class='ui medium header'  id="3motivations">3. Motivations</h2>
<p><em>This section is informative.</em></p>
<p>The goal of this specification is to define the overall requirements for a layered system architecture that enables interoperable trust relationships between any set of endpoints on the Internet. This is directly analogous to the role the TCP/IP stack plays in enabling interoperable data exchange between any set of endpoints on the Internet. The design patterns applicable to solving these interoperability challenges, and the motivations for each, are detailed at length in <a href="https://trustoverip.org/permalink/Design-Principles-for-the-ToIP-Stack-V1.0-2022-11-17.pdf">Design Principles for the ToIP Stack</a>.</p>
<p>Whether from the perspective of an implementer, a customer, or a policymaker, there are many benefits to a well-defined layered architecture:</p>
<ul class='ui list' >
<li class='ui item' ><p><strong>Engineering stability.</strong> The abstraction of bundling technologies and policies within distinct layers isolates changes within a layer from interactions and dependencies between layers. The result is a framework more resilient to structural changes than when the layers are not separated.</p></li>
<li class='ui item' ><p><strong>Wide adoption through a principled trust spanning layer.</strong> The TCP/IP stack features a simple minimalistic protocol (the <a href="https://en.wikipedia.org/wiki/Internet_Protocol">Internet Protocol</a>) as a universal spanning layer. More diverse task-specific protocols are built on top of this spanning layer (e.g., TCP for connection-oriented, UDP for connectionless). In the case of ToIP, a trust spanning layer based on a well-grounded set of design principles can maximize adoption, interoperability and reachability.</p></li>
<li class='ui item' ><p><strong>Reliability.</strong> A well-defined architecture enables the development of software components and applications that can be trusted to act in predictable, reliable ways—and that can expect other components and applications to do the same.</p></li>
<li class='ui item' ><p><strong>Interoperability and vendor independence.</strong> As with the TCP/IP stack, the Bluetooth stack, the NFC stack, or other protocol stacks, implementations from multiple vendors can and should be interoperable, both with current standards, and as they evolve over time. Customers should be able to switch between them without major loss of functionality.</p></li>
<li class='ui item' ><p><strong>Development communities.</strong> A well-designed architecture stack helps spawn a robust, diverse community of developers building solutions whose interoperability depends on a core stack. More development attracts more innovation, more innovation attracts more adoption, producing a network effect benefiting the entire ecosystem.</p></li>
<li class='ui item' ><p><strong>Commoditization.</strong> Standardization of a stack for mass adoption commoditizes it, reducing both the cost of implementation and the time to market. It also frees vendors to focus on their proprietary differentiation in their service offerings.</p></li>
<li class='ui item' ><p><strong>Public policy.</strong> A well-defined architecture with clear and concise terminology helps policymakers and legal experts define coherent policies and regulations in a manner that serves the needs of society without constraining technical innovation and competition. </p></li>
</ul>
<h2 class='ui medium header'  id="4audiencepurposeandscope">4. Audience, Purpose and Scope</h2>
<p><em>This section is informative.</em></p>
<p>The audience for this specification is protocol designers, system architects, software developers and product managers who wish to understand, influence, design, develop, or implement interoperable decentralized digital trust infrastructure, services, or applications.</p>
<p>The purpose of is specification is to define a reference architecture for the technology side of the ToIP stack, including the functions and behaviors required for each of the four layers and the functional and behavioral inter-dependencies between the layers:
     - What each layer must do.
     - What each layer should and may do.
     - What behaviors are expected to support interoperability.
     - What interactions each layer supports for other layers.</p>
<p>The goal of these architectural requirements is to inform subsequent development tracks as summarized in Figure 2:</p>
<p><img src="/images/StackDevTrack.png" alt="ToIP Stack Development Track" style="width:800px;"/></p>
<p><strong>Figure 2: The planned progression of development tracks for the ToIP Technology Stack</strong></p>
<p>For more information about the interrelationship and progression of these four development tracks, please see Appendix B: Evolution of the ToIP Stack. </p>
<p>The scope of this specification is limited to the Technical Architecture Track above, i.e., to defining the normative architectural requirements needed to guide the Component Specification Track. Success will be achieved if these requirements are sufficient to produce the component specifications needed to implement the architecture and prepare for the Interoperability Testing Track. </p>
<p>By focusing solely on the Technical Architecture Track, the following are explicitly out-of-scope:</p>
<ol>
<li class='ui item' >The definition of specific protocols or interfaces at each layer (these will be produced in the Component Specifications Track).</li>
<li class='ui item' >The definition of specific interoperability profiles and test cases—including both vertical and horizontal interoperability—that can be used for commercial-grade test harnesses and testing labs (these will be produced in the Interoperability Testing Track).</li>
<li class='ui item' >The definition of specific intermediary systems or supporting systems for any layer.</li>
<li class='ui item' >The definition of specific applications (and their user interfaces) that run on top of the ToIP stack.</li>
<li class='ui item' >The definition of ToIP Governance Stack components such as trust frameworks or governance frameworks for usage of the ToIP stack within specific digital trust ecosystems.</li>
</ol>
<p><em>NOTE: We do not expect all of these additional deliverables, especially the component specifications, to be produced by the ToIP Technology Stack Working Group (or other ToIP Working Groups). Some have already been produced—and others are in development—by other standards development organizations (such as the Decentralized Identity Foundation, W3C, IETF, ETSI, and ISO), independent governing authorities, and independent developers.</em></p>
<p><em>NOTE: Due to the public policy implications, the ToIP Foundation is committed to producing a companion document called <strong>ToIP Primer for Policymakers</strong>. This document will guide policymakers, governing authorities, analysts, and other non-technical audiences who need to deeply understand the purpose, uses, and implications of the ToIP stack but do not need (or want) to dive into technical details.</em></p>
<h2 class='ui medium header'  id="5exampleusecases">5. Example Use Cases</h2>
<p><em>This section is informative.</em></p>
<h2 class='ui medium header'  id="6referencearchitectureoverview">6. Reference Architecture Overview</h2>
<p><em>This section is informative.</em></p>
<h3 class='ui small header'  id="61designgoals">6.1 Design Goals</h3>
<p>A reference architecture of a complex system is an abstract framework consisting of a list of functional subsystems together with the interfaces and protocols needed to define the potential interactions and dependencies between these systems and/or external systems. This reference architecture provides a logical articulation of these interfaces and protocols which can then be translated into specific component specifications as described in Figure 2.</p>
<p>Such a reference architecture is an exercise in design guided by a set of most significant goals or principles. The overarching goals for the ToIP stack are twofold:</p>
<ol>
<li class='ui item' >Define a general means of establishing trust between any two or more endpoint systems,</li>
<li class='ui item' >Achieve universal interoperability among implementations.</li>
</ol>
<p>These twin objectives led the ToIP Foundation to begin the work with the Design Principles Track in Figure 2. In 2021, we developed a set of 17 <a href="https://www.trustoverip.org/wp-content/uploads/Design-Principles-for-the-ToIP-Stack-V1.0-2022-01-17.pdf">Design Principles for the ToIP Stack</a> that are the basis for the design choices reflected in this specification. For the full rationale behind each design principle, see <a href="https://www.trustoverip.org/wp-content/uploads/Design-Principles-for-the-ToIP-Stack-V1.0-2022-01-17.pdf">Design Principles for the ToIP Stack</a>.</p>
<p>With regard to the first design goal, establishing trust between parties requires that each party develop confidence in the following properties of their relationship:</p>
<ol>
<li class='ui item' ><strong>Authenticity:</strong> is the receiver of a communication able to verify that it originated from the expected sender?</li>
<li class='ui item' ><strong>Integrity:</strong> is the receiver able to verify that a communication is complete and has not been tampered with?</li>
<li class='ui item' ><strong>Confidentiality:</strong> is the contents of a communication protected so only authorized parties have access?</li>
<li class='ui item' ><strong>Privacy:</strong> will the expectations of each party with respect to usage of shared information be honored by the other parties?</li>
</ol>
<p>Note that, in some trust relationships, confidentiality and privacy may be optional. Thus our design goal with the ToIP stack is to achieve these four properties in the order listed.[^1]</p>
<p>[^1]: Another standard information trust criteria is <strong>availability</strong>. This is a concern with the design and implementation of operational deployments of the ToIP stack and should be addressed in the associated operational governance frameworks.</p>
<p>With regard to the second design goal, the ToIP reference architecture shares the same goal of global scalability as the original Internet architecture. This involves several intertwined considerations that overlap and reinforce each other as summarized by the first four <a href="https://www.trustoverip.org/wp-content/uploads/Design-Principles-for-the-ToIP-Stack-V1.0-2022-01-17.pdf">Design Principles for the ToIP Stack</a>:</p>
<ol>
<li class='ui item' >The End-to-End Principle</li>
<li class='ui item' >Connectivity Is Its Own Reward (Universal Interoperability)</li>
<li class='ui item' >The Hourglass Model</li>
<li class='ui item' >Decentralization</li>
</ol>
<h3 class='ui small header'  id="62thefourlayerpattern">6.2 The Four Layer Pattern</h3>
<p>Together these considerations lead to the general <em>four-layer pattern</em> of a protocol stack summarized in Table 1.</p>
<p>| Leyer # | Generic Name | ToIP Name |
|---------|--------------|-----------|
| 4       | Applications | Trust Applications |
| 3       | Supported protocols | Trust Tasks |
| 2       | Spanning protocol | Trust Spanning |
| 1       | Supporting protocols | Trust Support |</p>
<p><strong>Table 1: The four layer pattern of large-scale protocol stacks</strong></p>
<p>The best-known example of this four-layer pattern is the TCP/IP Internet protocol stack, where any number of local area networking protocols at Layer 1 support a single spanning layer protocol—the IP protocol—at Layer 2. This spanning layer in turn supports multiple higher-level protocols at Layer 3 (e.g., TCP, UDP, HTTP, SMTP) designed to meet the needs of many different applications at Layer 4.</p>
<p>Much of the success of the Internet is attributed to this “hourglass” design in which the spanning layer protocol maximizes interoperability by providing a common way for all the higher level layers to communicate with all the lower level layers. This is why the design of the trust spanning layer should be “as simple as possible but no simpler”. Figure 3 illustrates how this same hourglass design applies to the four ToIP layers.</p>
<p><img src="/images/HourGlass.png" alt="Four layer pattern in the hourglass model" style="width:500px;"/></p>
<p><strong>Figure 3: How the four layer pattern fits the Hourglass Model</strong></p>
<p>A more detailed overview showing where different decentralized digital trust infrastructure functions fall relative to the trust spanning layer is shown in Figure 4.</p>
<p><img src="/images/ExampleStack.png" alt="Examples of what falls above and below the trust spanning layer" style="width:800px;"/></p>
<p><strong>Figure 4: Examples of what falls above and below the trust spanning layer</strong></p>
<h3 class='ui small header'  id="63highlevelsystemarchitecture">6.3 High-Level System Architecture</h3>
<p>This section describes a reference architecture for ToIP that provides a generalization of various viable solutions for trust establishment over the Internet. It provides the common concepts and vocabulary with which to discuss implementations of each component, the protocols or interfaces between these components, and interoperability among different implementations. Subsequent sections will describe these components and protocols in more detail.</p>
<p>At the highest level, a ToIP system consists of three base types of component systems that together all interact using the common infrastructure of the Internet:</p>
<ol>
<li class='ui item' >At least two Endpoint Systems (often simply referred to as Endpoints).</li>
<li class='ui item' >A set of zero or more Supporting Systems that support trust establishment among the Endpoint Systems.</li>
<li class='ui item' >A set of zero or more Intermediary Systems that may be employed to assist the interactions between the Endpoint Systems. </li>
</ol>
<p>This high level view is depicted in Figure 3.</p>
<p><img src="/images/Highlevelreferencearchitecture.jpeg" alt="High level view of the ToIP Reference Architecture" style="width:800px;"/></p>
<p><strong>Figure 3: High Level View of the ToIP Reference Architecture</strong></p>
<p>The first level of decomposition is based on the locus of control. This is a critical decision because the locus of control determines the chains of dependencies as we construct end-to-end trust between any two Endpoint Systems. Each subsystem, whether it is classified as an Endpoint System, Supporting System, or Intermediary System, is its own locus of control. An Endpoint System, for example, may be a tiny IoT device, a personal smartphone, or a large capacity service hosted in a cloud. What matters to the architecture is that it exhibits a consistent locus of control with respect to other subsystems.</p>
<p>These subsystems collaborate with each other through three types of interactions:</p>
<ul class='ui list' >
<li class='ui item' >Endpoint System to Endpoint System</li>
<li class='ui item' >Endpoint System to Supporting Systems</li>
<li class='ui item' >Endpoint System to Intermediary Systems</li>
</ul>
<p>The ToIP Endpoint Systems follow a 4-layered design pattern. As we move up the stack, roles played by an Endpoint System are often given more context specific names. For example, a credential exchange Trust Task in layer 3 may use terms such as issuers, holders, and verifiers to describe such roles played by the Endpoint Systems and the interactions among them in that context. These higher layer terms are specific to that context and must be consistent with the abstract and general terms used in this Reference Architecture.</p>
<p>The normative requirements for each type of subsystem and interaction across the ToIP layers are specified in the following sections.</p>
<h2 class='ui medium header'  id="7endpointsystemsandthelayeredstack">7. Endpoint Systems and the Layered Stack</h2>
<h3 class='ui small header'  id="71endpointsystems">7.1 Endpoint Systems</h3>
<h3 class='ui small header'  id="72layer1infrastructures">7.2 Layer 1 (Infrastructures)</h3>
<h3 class='ui small header'  id="73layer2trustspanning">7.3 Layer 2 (Trust Spanning)</h3>
<h3 class='ui small header'  id="74layer3trusttasks">7.4 Layer 3 (Trust Tasks)</h3>
<h3 class='ui small header'  id="75layer4applications">7.5 Layer 4 (Applications)</h3>
<h2 class='ui medium header'  id="8thetoiptrustspanningprotocol">8. The ToIP Trust Spanning Protocol</h2>
<h3 class='ui small header'  id="81overview">8.1 Overview</h3>
<h3 class='ui small header'  id="82identifier">8.2 Identifier</h3>
<h3 class='ui small header'  id="83messages">8.3 Messages</h3>
<h3 class='ui small header'  id="84routing">8.4 Routing</h3>
<h3 class='ui small header'  id="85interfacetolayer1">8.5 Interface to Layer 1</h3>
<h2 class='ui medium header'  id="9supportingsystems">9. Supporting Systems</h2>
<h3 class='ui small header'  id="91overview">9.1 Overview</h3>
<h3 class='ui small header'  id="92example1">9.2 Example 1</h3>
<h3 class='ui small header'  id="93example2">9.3 Example 2</h3>
<h3 class='ui small header'  id="94generalization">9.4 Generalization</h3>
<h2 class='ui medium header'  id="10intermediarysystems">10. Intermediary Systems</h2>
<h2 class='ui medium header'  id="11endpointsysteminteroperability">11. Endpoint System Interoperability</h2>
<h3 class='ui small header'  id="111interoperabilitybetweenendpointswithdecentralizedidentifiers">11.1 Interoperability between Endpoints with Decentralized Identifiers</h3>
<h3 class='ui small header'  id="112interoperabilitybetweenendpointswithdecentralizedandotheridentifiers">11.2 Interoperability between Endpoints with Decentralized and Other Identifiers</h3>
<h2 class='ui medium header'  id="12integrationwiththetoipgovernancestack">12. Integration with the ToIP Governance Stack</h2>
<h2 class='ui medium header'  id="13references">13. References</h2>
<h2 class='ui medium header'  id="aboutthetoipfoundation">About the ToIP Foundation</h2>
<h2 class='ui medium header'  id="appendixaconsolidatedrequirements">Appendix A: Consolidated Requirements</h2>
<h2 class='ui medium header'  id="appendixbmappingofexistingtechnologiesintothetoipstack">Appendix B: Mapping of Existing Technologies into the ToIP Stack</h2>

</body>
</html>
